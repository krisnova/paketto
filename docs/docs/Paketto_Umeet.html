<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html>
<head>
	<title>linux.log</title>
	<meta name="generator" content="irclog2html.pl by Jeff Waugh">
	<meta name="version" content="Version 0.9 - 5th April 2000">
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
</head>
<body text="#000000" bgcolor="#ffffff"><tt>
<table cellspacing=3 cellpadding=2 border=0>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">greetings everyone; this is the last presentation of the day for the opening day of UMeet 2002</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">and, wrapping up the presentations is dan kaminsky; he spent two years as a security engineer for cisco</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">he is here today to present some networking tools called paketto keiretsu</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">so please welcome dan :)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Hello everyone :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">As Seth mentioned, I recently released a package of tools I'm calling the Paketto Keiretsu</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">If you're looking for them, they can be found at this URL:&nbsp;&nbsp;<a href="http://www.doxpara.com/paketto/paketto-1.0.tar.gz">http://www.doxpara.com/paketto/paketto-1.0.tar.gz</a></font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Though 1.01 should be out as soon as I fix an annoying build screwup :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Essentially, I've been researching the following question:</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">If I take direct control of the network -- fabricate my own packets, build my own stacks with no particular respect for the original meaning of data fields...</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">what could I do?</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Crashing machines isn't particularly interesting to me</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">But there's lots of interesting functionality that networks can't provide</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Yet :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Well, I didn't succeed in everything I set out to accomplish (for example, there's still no good way to quickly scan for open UDP ports), *but* I did find quite a bit of untapped potential within existing TCP/IP networks</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">and that's what we're going to talk about today.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Probably the most useful component of the Keiretsu is scanrand.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">scanrand is a stateless TCP scanner with the secondary capability to discover routes as well as endpoints</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">It can very quickly iterate across hosts, ports, and hops to provide a detailed view of available services and routes on a network</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Because of its stateless infrastructure, "Very Quickly" takes on a bit of a new meaning</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">During testing, scanrand was configured to examine the class B network of a major multinational corporation</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This was done with their full consent, of course :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">65K hosts received a probe against their HTTP port</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">8300 hosts responded affirmatively; many more responded negatively</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This scan took approximately four seconds to complete.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The architecture of scanrand is actually quite simple.&nbsp;&nbsp;Upon instantiation, the app splits into two halves:&nbsp;&nbsp;One that sends a massive number of connection initations, or "SYNs"; another that receives those SYNs and parses out who claims to be up and who claims to be down.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">There is no inter-process communication between these processes</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Rather, everything that needs to be known about a scan request is parsed from the endpoint-provided scan reply.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This means that one machine can efficiently scan 65K endpoints, or even many, many more, without having to keep a progressively larger amount of memory occupied for the eventual responses that may or may not come</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">such is the reason why previous attempts at very fast scanning -- even parallelized with sockets -- have topped out at 100 scans a second or so</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Now, one problem with a stateless approach is that if we're not keeping track of who we communicate with, somebody could notice "Heh, this guy is scanning us without any care for who he's scanning...lets send back fake replies" </font></tt></td></tr>
<tr><th bgcolor="#818144"><font color="#ffffff"><tt>viZard</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#818144">dan, can you wait a sec please? :)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">viZard sure :-)</font></tt></td></tr>
<tr><th bgcolor="#818144"><font color="#ffffff"><tt>viZard</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#818144">ok, thanks. keep going</font></tt></td></tr>
<tr><td colspan=2><tt><font color="#CC00CC">* DanKamin has never had live translation during a talk :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Thank you, viZard!</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">(and garoeda, providing translations in #taee as well... dutch, I believe. :)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Thank you too, garoeda :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Now, this is a mere annoyance at best, but depending on what might get built using scanrand (particularly with database backends), this could be the channel for a serious security hole</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">I come from a security background (I've done quite a bit of work with OpenSSH), so this is unacceptable :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So the solution is to use what I refer to as Inverse SYN Cookies</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font
color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%"
bgcolor="#eeeeee"><tt><font color="#42427e">In TCP, When you send a SYN to
request a connection, you receive either a SYN|ACK(the port is up) or a
RST|ACK(the   port is up) or a RST|ACK(the port is down)
   Both SYN|ACKs and RST|ACKs have lots more to them than just "Up" or "Down"...among other things, they contain all the addressing information we needed to be able to statelessly determine who we sent a request to and what port we were looking at</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">But also</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">They contain a 32 bit number of our own choosing from the SEQ#</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">er</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">from the SYN</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">this number is known as the Sequence Number, or SEQ#</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">and it is *reflected* in the Acknowledgement Number, or ACK#, of any valid SYN|ACK or RST|ACK</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">32 bits is enough to include a cryptographically strong variable that links a given response to a valid scan</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">In technical terms, we use SHA-1 in the HMAC, or Hashed Message Authentication Code, construction to create a 160 bit value corresponding to the combination of (source IP, source port, destination IP, destination port)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Then the first 32 bits are chopped off and thrown into the SEQ#</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">when the SYN|ACK or RST|ACK returns, we reverse the process(and decrement the ACK# by one, because the reflection is incremented) to see if this host actually received a scan from us</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">HMAC involves a secret value known only to the scanner</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">so this leaves a host with a choice -- reply with the valid information, or do not reply -- because anything invalid can be easily ignored.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e"><a href="http://www.doxpara.com/read.php/docs/scanrand_logs.html">http://www.doxpara.com/read.php/docs/scanrand_logs.html</a></font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Here you will find logs of Scanrand being used</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">As you can see in the local scan -- 254*20 ports are scanned on my local 100mbit LAN, and results are collated within 0.182 seconds</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Of note is the capacity to do passive hopcount estimation</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">this is a simple technique, but it's surprisingly successful</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Simply assume remote hosts started sending packets at some value modulo 32 -- 64, 128, 255(close enough)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">then whatever difference you get from that value, that's the number of hops the packet took to get to you</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">so when I scan Slashdot, it appears to be about 12 hops away</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">well, lets verify that -- but of course, it's me, so lets verify it statelessly :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Scanrand's stateless traceroute takes advantage of a heretofore ignored fact</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">ICMP errors contain more than just "something screwed up"</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">They also contain a full copy of the offending IP header and the first 8 bytes of the Layer 4 data contained inside</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">TCP/UDP/ICMP</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So, traceroute works as follows:</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">There exists in IP a value called the TTL</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This stands for Time To Live</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">TTL is SUPPOSED to refer to seconds, but its evolved to become hops the packet is allowed to travel through before its dropped</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So if a TTL is 5, it will go 5 hops and then die</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">sending back an ICMP Time Exceeded Message (which has the IP and TCP header, hint hint)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So a Traceroute just sends a packet with a TTL of 1, 2, 3, 4, 5, etc. until it gets all the way there</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">a stateless traceroute just sends all the iterations at once -- in the example's case, from 1 to 13 get sent</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">when responses come back, we look at the IP and TCP headers contained inside to figure out who we were trying to scan</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">in this case, every time we were looking at 66.35.250.150</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">At the end of the scan, we see that our estimation of 12 hops was a bit off--it was in fact 13 hops away</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">but as we'll see later, the estimation remains very useful</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Later examples demonstrate more advanced modes of Scanrand</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">DNS resolution is presently synchronous, so it slows down operation...ideally, you'd use a tool that automagically takes in HTTP logs w/ IPs and replaces all the IPs with their DNS names</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">there's quite a few out there, if I remember right</font></tt></td></tr>
<tr><td colspan=2><tt><font color="#CC00CC">* sarnold sets mode: +o DanKamin</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Small technical difficulties out here, sorry for disappearing :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">One of the more interesting things bout a combined port scanner and tracerouter is that we can do both at the same time</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This is shown by the next entry in the scanrand logs (again, at <a href="http://www.doxpara.com/read.php/docs/scanrand_logs.html">http://www.doxpara.com/read.php/docs/scanrand_logs.html</a> )</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The returns are out-of-order, but as you can see, while first hops are all identical, the farther out we get, the more divergent our scan becomes</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">this is of course what we'd expect</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Future versions of scanrand are going to explicitly support remote mesh discovery</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">this is going to involve source routing to a known point n hops away, setting TTL to n+1, then attempting to reach various addresses expected to be as far away as possible from eachother in remote routing tables</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">the speed of the stateless approach should render most networks traceable in astonishingly little time</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">but we'll see :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">One thing of note is the fact that it is very feasible to split the scanning and receiving processes across machines</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">so for example, one system could be designated the scan collector, while everyone else has their results forwarded to it</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This is almost an alternate mode of source routing :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">and it's demonstrated in the final log entry</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Next up is paratrace, which is actually a fork of scanrand</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">split off because it really does something different t</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">than it</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e"><a href="http://www.doxpara.com/read.php/docs/paratrace_logs.html">http://www.doxpara.com/read.php/docs/paratrace_logs.html</a></font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">While scanrand initiates new connections to search networks, paratrace uses existing connections</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This is the only effective way to monitor policy routes, and can also penetrate through stateful firewalls</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The idea is simple:&nbsp;&nbsp;Traceroute is entirely a Layer 3 activity -- iterate the TTL, observe the ICMP Time Exceeded reply.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">It doesn't matter what we have at Layer 4.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So if Layer 4 is valid TCP traffic, Traceroute doesn't care</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Now, TCP has the capacity to support redundant packets -- it's just expected as part of the unreliable network that IP offers</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">in fact, this feature is used for a sort of in-session TCP ping, "tcp keepalive"</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Essentially, paratrace uses keepalives as the transport for a IP Traceroute</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The results of which are seen in the logs</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">passive hopcount estimation is used to figure out just how far to iterate the parasitic traceroute.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Switching gears a bit, lets talk about Minewt.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">As I mentioned, the original design goal of Paketto was to examine what could be done by directly manipulating the wire</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Minewt is a NAT gateway that operates entirely in software, directly manipulating the wire to instantiate itself</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">It uses no kernel resources, save for the raw network connectivity afforded through libnet/libpcap's manipulation of sockets and bpf.</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">BPF?</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Indeed, not even the MAC address is shared with the kernel -- it literally looks like a new device showed up on the wire.</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">does linux do BPF? I thought it had netlink or similar in place of bpf...</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">BPF is the Berkeley Packet Filter, a standardized interface for requesting network traffic that matches a standard form.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">As sarnold points out, bpf itself is not directly implemented by all kernels</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Libpcap thus implements bpf in userspace when needed -- though I believe they have their own kernel interface for Linux</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The main point is that the Paketto overall is quite insulated from the vagaries of various kernel networking interfaces; just give me frames, I'll do the rest :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">(vagaries = strangeness)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So, looking at the minewt logs at <a href="http://www.doxpara.com/read.php/docs/minewt_logs.html">http://www.doxpara.com/read.php/docs/minewt_logs.html</a></font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This is what happens:</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">./minewt -i 10.0.1.180 -I 10.0.1.190 -r 10.0.1.254 -v</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">-i 10.0.1.180&nbsp;&nbsp;== The IP that machines on my network should talk to is 10.0.1.180</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">-I 10.0.1.190&nbsp;&nbsp;== The IP that the outside world expects to be hearing from is 10.0.1.190</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">-r 10.0.1.254&nbsp;&nbsp;== The IP that I will be routing packets towards (the default gateway) is 10.0.1.254</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">-v is just verbose</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Now, one thing to notice is that very quickly minewt starts picking up traffic and NATting it correctly</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Minewt is a stateful program, but it's a flexible one -- any outgoing packet, SYN, TCP Keepalive, or whatnot, contains the necessary state to start a session</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So between that and the fact that minewt controls its own MAC addresses,</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">it's actually possible to start minewt on one machine, kill it, then start it on another, and *no hosts lose connectivity*</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Speedwise, minewt is quite fast -- sub-ms delay!</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">FreeBSD is probably the fastest platform, but I've had few issues elsewhere.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">In terms of queso/xprobe identification, minewt really offers only one service:&nbsp;&nbsp;ICMP Echo -&gt; ICMP Echo Reply</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">It uses the incoming ping to construct the outgoing ping reply, so I expect there is some form of ping that *only* minewt would generate</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">I haven't tested this though.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Upon receiving a ping, minewt dumps the present state table -- this is noted at the end of the logs.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Minewt has two features which are moderately interesting</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">First of all, Minewt implements what I refer to as MAC Address Translation</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This feature really comes for free as part of the infrastructure.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Because I don't use the kernel, I can't take advantage of any of its niceties like the ARP cache</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">ARP exists to map L3(IP) to L2(MAC)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Now, here's what's interesting</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">the way NAT works is to map the local port on an outgoing connection to the internal IP address that spawned it</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">effectively</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">NAT maps L4(Port) to L3(IP)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">and</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">ARP maps L3(IP) to L2(MAC)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">so transitively, we can have MAT map L4(Port) to the combination of L3(IP) and L2(MAC)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">and since we don't have the kernel ARP cache, we pretty much have to :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This has an interesting side effect</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">We now don't care what IP address the backend client picks</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">if they want to be a 10.* IP, no problem</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">If they want to have the external IP address -- the *REAL* IP address -- no problem as well</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">if ten of them want to have the external IP</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">still no problem</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">because their MACs are all different</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">this means, in a limited set of circumstances, packet integrity can be maintained</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">An interesting question was asked:</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">&lt;Zanshin&gt; So with minewt running you can hide behind this virtual router and not be traced back? Since when you quit the router is gone... or are there still any traces?</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Minewt is as effective as changing your MAC address and IP address.&nbsp;&nbsp;If this will evade some tracing functionality, so will minewt.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">You will almost always be traceable to your subnet, since minewt needs to route into something.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Another interesting feature that Minewt supports is Guerilla Multicast</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">this will be much more deeply explored in the next major build of Paketto</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">But the basic idea is to get around one of my big annoyances of modern networks:&nbsp;&nbsp;One packet, one destination</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">I want to send one packet, to many destinations, with the internet as it is today</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">In case you haven't noticed, the internet doesn't support multicast too well</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">by which i mean at all :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The internet -- the IP routable universe -- is indeed locked on unicast</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">but we don't directly connect at the layer of IP -- we tend to use ethernet to interface with IP, and ARP translates Ethernet MACs to Internet IP's</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Ethernet supports broadcast and multicast just fine -- MAC of FF:FF:FF:FF:FF:FF or 01:00:5E:??:??:??, respectively</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Now, remember how we use ARP to link MACs to IP?</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Lets use ARP to link a *Unicast* IP, perfect for the Internet, to a *Broadcast/Multicast* IP address, perfect for everyone on our LAN</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">That way, when the upstream router wants to return packets, they'll ARP, see BC/MC, and send that to the switch -- which of course will split the frame out to everyone</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">oooh :)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">As is, there's little we can do with this besides sniff all traffic coming out of Minewt.&nbsp;&nbsp;MUCH more interesting work with this technique is coming in future builds, however.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The Helix Community Source is expected to get quite the workout</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">One IP on a LAN will be designated the unicast IP that all shared transmissions are routed through</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">And every viewing client will share the load of responding to packets -- UDP if necessary, TCP as needed</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">But that's 1.1 / 2.0 talk :-D</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">There's many, many things possible with raw networking</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">quite a few of which I hope I don't have to write!</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">While C has great support for directly connecting to the wire, other languages don't.&nbsp;&nbsp;I'd like to bring programmers of those languages into the fold</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Thus is the purpose of Linkcat, or lc.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">lc is basically netcat at layer 2 -- give me data, I throw it on the wire.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">netcat throws it into a TCP session</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">linkcat literally throws it onto the ether</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e"><a href="http://www.doxpara.com/read.php/docs/lc_logs.html">http://www.doxpara.com/read.php/docs/lc_logs.html</a></font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">This shows logs of linkcat allowing me to cut and paste an ICMP echo</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">text-mode ethereal proves we're actually sending a valid packet</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">linkcat supports both a near-raw packet mode based on libpcap (you can throw tcpdump logs into linkcat for retransmission, though tcpreplay is a better tool for that)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">and the ASCII mode seen in the logs</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Of some note is the support for HMACs in Ethernet Trailers.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">IP has an explicit length field that says how much it cares about</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">but Ethernet lets you throw more on, up to the Maximum Transmission Unit(MTU) size</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">so we can just throw extra data there -- including an optionally parsed cryptovariable that authenticates the data!</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So if you ever wanted to sign your ARPs</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">this is one way to do it :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Much more work will be done using Ethernet Trailers in future builds -- this is a proof of concept</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Linkcat will sign arbitrary frames using a shared secret, as is.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Finally, last, but not least.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Pretty pictures!</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e"><a href="http://www.doxpara.com/pics/index.php?album=phentropy/">http://www.doxpara.com/pics/index.php?album=phentropy/</a></font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Based on the excellent research of Michel Zalewski (<a href="http://razor.bindview.com/publish/papers/tcpseq.html),">http://razor.bindview.com/publish/papers/tcpseq.html),</a> phentropy provides three dimensionsal visualization of the randomness of arbitrary datasets</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">usage is simple:</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">phentropy data</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">if it's ascii formatted,</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">phentropy -a data</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Output is quite interesting.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">bash_rand1 is probably the most directly useful -- this is a plotting of Bash's $RAND variable</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">it exhibits notable planes and clumps -- not something you'd expect from genuinely random data</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">bash_rand2 shows the dataset rotated</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The tool used to do these renderings is exceedingly fast.&nbsp;&nbsp;Released at SIGGRAPH 2002 and now available at openqvis.sourceforge.net, OpenQVIS renders *arbitrary* three dimensional datasets in realtime, using Pixel shader hardware found in advanced 3D cards</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">It's good to do more with 3D hardware than blow things up :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Intentionally nonrandom input renders *really* interestingly.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The BSD Kernel looks akin to a Borg Cube.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">The default background to Windows XP ends up looking like a set of three triangles.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">A comparison of the left channel and right channel of some music I wrote a while back turned out the most interesting -- it became a pipe, with an apparently near hollow interior (see&nbsp;&nbsp;stereo_r_vs_l_8)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Linkcat has a mode -- -o m-n -- to emit data suitable for phentropy to visualize</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">It will be very interesting over the next few months to see what phentropy/openqvis make of many datasets.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">In terms of what phentropy represents... take four values from the data:&nbsp;&nbsp;a, b, c, d.&nbsp;&nbsp;In between those four are three deltas -- b-a, c-b, d-c.&nbsp;&nbsp;Make those three an X,Y,Z point, and plot it</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">That's what each point is.</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Now, the set of all points can basically be interpreted as clustering behavior -- these are sections where deltas, no matter how they're distributed across the total range of values, always end up being similar</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">truly random data should have no clusters</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">very nonrandom data (like the slashdot comments) should focus on only a few known zones</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">So that's that!</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Lots more coming to Paketto for 2003,</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">but that's what we've got going now :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">If you've got any questions, lemme know...but that's all I've got for ya now :-)</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">DanKamin: great! :)</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">DanKamin: many thanks for the presentation :)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">*bows*</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">i'd like to thank dan, raciel, acs, and riel for giving top-notch presentations today</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Thanks for the invite :-)</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">and I'd like to thank all our translators, making uninet available to so many more people ;)</font></tt></td></tr>
<tr><th bgcolor="#407a40"><font color="#ffffff"><tt>sarnold</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#407a40">and with that, I bid you all goodnight, because I've got a bus to catch! :)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Don't miss da bus :-)</font></tt></td></tr>
<tr><th bgcolor="#854685"><font color="#ffffff"><tt>zanshin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#854685">thanks for the presentation DanKarmin. </font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">You're welcome... hopefully the tools will be of use!</font></tt></td></tr>
<tr><th bgcolor="#854685"><font color="#ffffff"><tt>zanshin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#854685">I will reread it tomorrow.... it's 03:34 now.... going to sleep :0) night.</font></tt></td></tr>
<tr><th bgcolor="#488888"><font color="#ffffff"><tt>Ston</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#488888">perl -e 'print "CLAP "x1000'</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">*laughs* nice, Ston</font></tt></td></tr>
<tr><th bgcolor="#488888"><font color="#ffffff"><tt>Ston</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#488888">=)))</font></tt></td></tr>
<tr><th bgcolor="#8c4a4a"><font color="#ffffff"><tt>DarkLinux</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#8c4a4a">hola a todos</font></tt></td></tr>
<tr><th bgcolor="#488888"><font color="#ffffff"><tt>Ston</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#488888">hmm i think everybuddy is sleeping! :(</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">About: GunStamp is a program which can be used whenever accurate timestamping of events are required. It syncronizes the computer clock to an external time source (a GPS) connected to a serial port, and then use this clock to timestamp events. The events are received as positive pulses (+5v - +15v) connected to the acknowledge interrupt on the parallel port. Timestamp accuracy should be within +/- 15us!</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Whoa!</font></tt></td></tr>
<tr><th bgcolor="#488888"><font color="#ffffff"><tt>Ston</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#488888">DanKamin: thanks a test a cgi log bitchx output with your presentation :)</font></tt></td></tr>
<tr><th bgcolor="#4b904b"><font color="#ffffff"><tt>passg1</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#4b904b">bien o no</font></tt></td></tr>
<tr><th bgcolor="#4b904b"><font color="#ffffff"><tt>passg1</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#4b904b">que se hizo hoy por aca, no pude venir</font></tt></td></tr>
<tr><th bgcolor="#4d4d93"><font color="#ffffff"><tt>Ducky_Pha</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#4d4d93">si y usted</font></tt></td></tr>
<tr><th bgcolor="#4b904b"><font color="#ffffff"><tt>passg1</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#4b904b">me dejo el bus :(</font></tt></td></tr>
<tr><th bgcolor="#4b904b"><font color="#ffffff"><tt>passg1</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#4b904b">bien</font></tt></td></tr>
<tr><th bgcolor="#4d4d93"><font color="#ffffff"><tt>Ducky_Pha</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#4d4d93">de que ciudad es</font></tt></td></tr>
<tr><th bgcolor="#4b904b"><font color="#ffffff"><tt>passg1</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#4b904b">medellin</font></tt></td></tr>
<tr><th bgcolor="#97974f"><font color="#ffffff"><tt>garoeda</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#97974f">pfoe...my hands are broken</font></tt></td></tr>
<tr><th bgcolor="#97974f"><font color="#ffffff"><tt>garoeda</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#97974f">translating is heavy suffering</font></tt></td></tr>
<tr><th bgcolor="#97974f"><font color="#ffffff"><tt>garoeda</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#97974f">anyway, what to do with the dutch logs?</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">garoeda thank you so much :-)</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">Send me a copy, send seth copy too</font></tt></td></tr>
<tr><th bgcolor="#4b904b"><font color="#ffffff"><tt>passg1</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#4b904b">hehe I better dont translate anything since I have an old and heavy IBM keyboard</font></tt></td></tr>
<tr><th bgcolor="#488888"><font color="#ffffff"><tt>Ston</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#488888">daniZzZz: thanks you too :)</font></tt></td></tr>
<tr><th bgcolor="#488888"><font color="#ffffff"><tt>Ston</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#488888">DanKamin: thanks you too :)</font></tt></td></tr>
<tr><th bgcolor="#97974f"><font color="#ffffff"><tt>garoeda</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#97974f">send ? via dcc or mail or ?</font></tt></td></tr>
<tr><th bgcolor="#42427e"><font color="#ffffff"><tt>DanKamin</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#42427e">dan@doxpara.com</font></tt></td></tr>
<tr><th bgcolor="#97974f"><font color="#ffffff"><tt>garoeda</tt></font></th><td width="100%" bgcolor="#eeeeee"><tt><font color="#97974f">ok, wrote it down, now, how to save it from Kvirc :-)</font></tt></td></tr>
</table>

<br>Generated by irclog2html.pl by <a href="mailto:jdub@NOSPAMaphid.net">Jeff Waugh</a>
 - find it at <a href="http://freshmeat.net/appindex/2000/03/28/954251322.html">freshmeat.net</a>!
</tt>
</body>
</html>
